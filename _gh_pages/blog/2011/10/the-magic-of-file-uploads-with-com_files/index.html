<!DOCTYPE html>
<html lang="en-US">
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,700italic,700,300' rel='stylesheet' type='text/css'>

	<title>The magic of file uploads with com_files</title>
	<meta name="description" content="In my last blog post, I wrote about the [awesome new file manager][1] that made its way into Nooku Server Alpha 3. In this blog post we are going to dive a l...">

	<link rel="stylesheet" href="/css/main.css">
	<link rel="canonical" href="http://derjoachim.nl/blog/2011/10/the-magic-of-file-uploads-with-com_files/">
	<link rel="alternate" type="application/rss+xml" title="Der Joachim" href="http://derjoachim.nl/feed.xml" />
	<script type="text/javascript">
		/*
		var _gaq = _gaq || [];
 	 	 _gaq.push(['_setAccount', 'UA-22946638-1']);
			_gaq.push(['_trackPageview']);

			(function() {
				var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
				ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
			})();
			*/
	</script>
</head>

	<body>
		<header class="site-header">
  <div class="wrapper">
    <a class="site-title" href="/">Der Joachim</a>
    <nav class="site-nav">
      <div class="trigger">
          
          <a class="page-link" href="/blog/2011/10/the-magic-of-file-uploads-with-com_files/">The magic of file uploads with com_files</a>
          
      </div>
    </nav>
  </div>
</header>

		<div class="post">

  <header class="post-header">
    <h1 class="post-title">The magic of file uploads with com_files</h1>
    <p class="post-meta">Oct 25, 2011 • ercan</p>
  </header>

  <article class="post-content">
    <p>In my last blog post, I wrote about the <a href="http://blog.nooku.org/2011/08/meet-com_files-joomla-file-management-2-0/">awesome new file manager</a> that made its way into Nooku Server Alpha 3. In this blog post we are going to dive a little deeper into how to re-use com_files in your own components. Meet my new friend : <a href="https://github.com/ercanozkaya/com_uploads">com_uploads</a>!</p>

<p>This is a proof of concept component that demonstrates two distinct features:</p>

<ol>
<li>A custom file upload controller that handles file uploads</li>
<li>A full featured interface for managing files in your special container</li>
</ol>


<p><a href="http://www.flickr.com/photos/nooku/6278348004/" title="Nooku Server - Files by Nooku, on Flickr"><img src="http://farm7.static.flickr.com/6224/6278348004_06cd5c7d30.jpg" alt="Nooku Server - Files" width="500" height="402" /></a></p>

<!--more-->




<h3 dir="ltr">
  Containers
</h3>


<p>The files component is not tied to a single folder anymore, instead it implements ‘containers’. Containers are like root folders and they contain parameters and access rules. This gives you the ability to use the component with different folders from completely unrelated paths.</p>

<p>With this abstraction, it will also be possible in the future to create &#8220;container types&#8221; which can gather their data from different cloud files systems (S3, <a href="http://www.dropbox.com/">Dropbox</a>, Flickr, …)</p>

<h3 dir="ltr">
  Setting up
</h3>


<p>To start using com_files in your component all you need to do is create your own container. In the <a href="about:blank">install file</a> you see an example of how to create your container programmatically. The slug of the container acts as a unique identifier for your container that you will later need to get to your file manager instance. That slug will be used in HMVC calls. Choose it wisely!</p>

<p>With our container ready, it is time to explore our first view. If you go to the Manage tab (which is the default layout of manage view) you will see our file manager ready to rock! That’s it.</p>

<h3 dir="ltr">
  Event hooks
</h3>


<p>When you examine the code of the manage view, you will notice that an event named “<em>onAfterNavigate</em>” is attached to log folder navigations . This is just one example of numerous events we have in the code base. We have more than a few dozen of them. For example, you can use <em>onAfterSetLayout</em> to detect layout switches. Or you can use <em>onBeforeDeleteNode</em> to act on deleted nodes.</p>

<p>Those events can be used to customize every aspect of the user experience from uploads to folder navigation. You can find the rest of them by searching for &#8220;<em>fireEvent</em>&#8221; in the com_files JavaScript classes.</p>

<h3 dir="ltr">
  Uploading files
</h3>


<p>The second &#8220;Upload&#8221; tab is rather plain. It is just an input box to show you how to handle file uploads in your code by yourself. You can see how that is done in the <a href="https://github.com/ercanozkaya/com_uploads/blob/master/administrator/components/com_uploads/controllers/upload.php">upload controller</a>.</p>

<p>If you examine the code, you will see that we pass the raw file path we get from PHP and let a simple HMVC call handle the rest.</p>

<p>This little controller can be used to add upload forms to already existing components, with just one line of code. For example, you can store resumes in a candidate form or store attachments in a forum without ever worrying about validation or file location.</p>

<p>You can see the full codebase on <a href="https://github.com/ercanozkaya/com_uploads">Github</a>. Give it a spin!</p>

  </article>

</div>

		<footer class="site-footer">

</footer>

	</body>
</html>
